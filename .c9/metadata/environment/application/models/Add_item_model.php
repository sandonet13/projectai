{"filter":false,"title":"Add_item_model.php","tooltip":"/application/models/Add_item_model.php","undoManager":{"mark":26,"position":26,"stack":[[{"start":{"row":7,"column":28},"end":{"row":7,"column":44},"action":"remove","lines":["material_request"],"id":2},{"start":{"row":7,"column":28},"end":{"row":7,"column":29},"action":"insert","lines":["i"]},{"start":{"row":7,"column":29},"end":{"row":7,"column":30},"action":"insert","lines":["t"]},{"start":{"row":7,"column":30},"end":{"row":7,"column":31},"action":"insert","lines":["e"]},{"start":{"row":7,"column":31},"end":{"row":7,"column":32},"action":"insert","lines":["m"]}],[{"start":{"row":14,"column":0},"end":{"row":22,"column":8},"action":"remove","lines":["        //$expenses_table = $this->db->dbprefix('expenses');","        $expense_categories_table = $this->db->dbprefix('expense_categories');","        $projects_table = $this->db->dbprefix('projects');","        $users_table = $this->db->dbprefix('users');","        $status_mr_table = $this->db->dbprefix('status_mr');","        //$taxes_table = $this->db->dbprefix('taxes');","        //$clients_table = $this->db->dbprefix('clients');","        $location_categories_table = $this->db->dbprefix('location_categories');","        "],"id":3}],[{"start":{"row":15,"column":0},"end":{"row":16,"column":0},"action":"remove","lines":["        // = $this->db->dbprefix('measurement');",""],"id":4}],[{"start":{"row":14,"column":0},"end":{"row":14,"column":4},"action":"insert","lines":["    "],"id":5}],[{"start":{"row":14,"column":59},"end":{"row":14,"column":75},"action":"remove","lines":["material_request"],"id":6},{"start":{"row":14,"column":59},"end":{"row":14,"column":60},"action":"insert","lines":["t"]},{"start":{"row":14,"column":60},"end":{"row":14,"column":61},"action":"insert","lines":["i"]},{"start":{"row":14,"column":61},"end":{"row":14,"column":62},"action":"insert","lines":["e"]},{"start":{"row":14,"column":62},"end":{"row":14,"column":63},"action":"insert","lines":["m"]}],[{"start":{"row":14,"column":62},"end":{"row":14,"column":63},"action":"remove","lines":["m"],"id":7},{"start":{"row":14,"column":61},"end":{"row":14,"column":62},"action":"remove","lines":["e"]},{"start":{"row":14,"column":60},"end":{"row":14,"column":61},"action":"remove","lines":["i"]},{"start":{"row":14,"column":59},"end":{"row":14,"column":60},"action":"remove","lines":["t"]}],[{"start":{"row":14,"column":59},"end":{"row":14,"column":60},"action":"insert","lines":["i"],"id":8},{"start":{"row":14,"column":60},"end":{"row":14,"column":61},"action":"insert","lines":["t"]},{"start":{"row":14,"column":61},"end":{"row":14,"column":62},"action":"insert","lines":["e"]},{"start":{"row":14,"column":62},"end":{"row":14,"column":63},"action":"insert","lines":["m"]}],[{"start":{"row":14,"column":9},"end":{"row":14,"column":25},"action":"remove","lines":["material_request"],"id":9},{"start":{"row":14,"column":9},"end":{"row":14,"column":10},"action":"insert","lines":["i"]},{"start":{"row":14,"column":10},"end":{"row":14,"column":11},"action":"insert","lines":["t"]},{"start":{"row":14,"column":11},"end":{"row":14,"column":12},"action":"insert","lines":["e"]},{"start":{"row":14,"column":12},"end":{"row":14,"column":13},"action":"insert","lines":["m"]}],[{"start":{"row":21,"column":32},"end":{"row":21,"column":48},"action":"remove","lines":["material_request"],"id":10},{"start":{"row":21,"column":32},"end":{"row":21,"column":33},"action":"insert","lines":["i"]},{"start":{"row":21,"column":33},"end":{"row":21,"column":34},"action":"insert","lines":["t"]},{"start":{"row":21,"column":34},"end":{"row":21,"column":35},"action":"insert","lines":["e"]}],[{"start":{"row":21,"column":27},"end":{"row":21,"column":41},"action":"remove","lines":["$add_ite_table"],"id":11},{"start":{"row":21,"column":27},"end":{"row":21,"column":42},"action":"insert","lines":["$add_item_table"]}],[{"start":{"row":24,"column":0},"end":{"row":75,"column":0},"action":"remove","lines":["        $date_request = get_array_value($options, \"date_request\");","        if ($date_request) {","            $where .= \" AND $add_material_request_table.date_request=$date_request\";","        }","        ","        $location_id = get_array_value($options, \"location_id\");","        if ($location_id) {","            $where .= \" AND $add_material_request_table.location_id=$location_id\";","        }","        ","        ","        $status_id = get_array_value($options, \"status_id\");","        if ($status_id) {","            $where .= \" AND $add_material_request_table.status_id=$status_id\";","        }","        ","        // $measurement_id = get_array_value($options, \"measurement_id\");","        // if ($measurement_id) {","        //     $where .= \" AND $expenses_table.measurement_id=$measurement_id\";","        // }","","        $category_id = get_array_value($options, \"category_id\");","        if ($category_id) {","            $where .= \" AND $add_material_request_table.category_id=$category_id\";","        }","","        $project_id = get_array_value($options, \"project_id\");","        if ($project_id) {","            $where .= \" AND $add_material_request_table.project_id=$project_id\";","        }","","        $user_id = get_array_value($options, \"user_id\");","        if ($user_id) {","            $where .= \" AND $add_material_request_table.user_id=$user_id\";","        }","","        // $client_id = get_array_value($options, \"client_id\");","        // if ($client_id) {","        //     $where .= \" AND $expenses_table.client_id=$client_id\";","        // }","","        // $recurring = get_array_value($options, \"recurring\");","        // if ($recurring) {","        //     $where .= \" AND $expenses_table.recurring=1\";","        // }","","        //prepare custom fild binding query","        // $custom_fields = get_array_value($options, \"custom_fields\");","        // $custom_field_query_info = $this->prepare_custom_field_query_string(\"expenses\", $custom_fields, $expenses_table);","        // $select_custom_fields = get_array_value($custom_field_query_info, \"select_string\");","        // $join_custom_fields = get_array_value($custom_field_query_info, \"join_string\");",""],"id":12},{"start":{"row":23,"column":8},"end":{"row":24,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":39,"column":0},"end":{"row":44,"column":5},"action":"remove","lines":["    function get_list()","    {","        $add_material_request_table = $this->db->dbprefix('add_material_request');","        $sql = \"SELECT MAX($add_material_request_table.id) AS ids FROM $add_material_request_table\";","        return $this->db->query($sql);","    }"],"id":13},{"start":{"row":38,"column":4},"end":{"row":39,"column":0},"action":"remove","lines":["",""]},{"start":{"row":38,"column":0},"end":{"row":38,"column":4},"action":"remove","lines":["    "]},{"start":{"row":37,"column":4},"end":{"row":38,"column":0},"action":"remove","lines":["",""]},{"start":{"row":37,"column":0},"end":{"row":37,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":37,"column":0},"end":{"row":93,"column":8},"action":"remove","lines":["","","","","    // function get_income_expenses_info() {","    //     $expenses_table = $this->db->dbprefix('expenses');","    //     $invoice_payments_table = $this->db->dbprefix('invoice_payments');","    //     $taxes_table = $this->db->dbprefix('taxes');","    //     $info = new stdClass();","","    //     $sql1 = \"SELECT SUM($invoice_payments_table.amount) as total_income","    //     FROM $invoice_payments_table","    //     WHERE $invoice_payments_table.deleted=0\";","    //     $income = $this->db->query($sql1)->row();","","    //     $sql2 = \"SELECT SUM($expenses_table.amount + IFNULL(tax_table.percentage,0)/100*IFNULL($expenses_table.amount,0) + IFNULL(tax_table2.percentage,0)/100*IFNULL($expenses_table.amount,0)) AS total_expenses","    //     FROM $expenses_table","    //     LEFT JOIN (SELECT $taxes_table.id, $taxes_table.percentage FROM $taxes_table) AS tax_table ON tax_table.id = $expenses_table.tax_id","    //     LEFT JOIN (SELECT $taxes_table.id, $taxes_table.percentage FROM $taxes_table) AS tax_table2 ON tax_table2.id = $expenses_table.tax_id2","    //     WHERE $expenses_table.deleted=0\";","    //     $expenses = $this->db->query($sql2)->row();","","    //     $info->income = $income->total_income;","    //     $info->expneses = $expenses->total_expenses;","    //     return $info;","    // }","","    // function get_yearly_expenses_chart($year, $project_id = 0) {","    //     $expenses_table = $this->db->dbprefix('expenses');","    //     $taxes_table = $this->db->dbprefix('taxes');","","    //     $where = \"\";","    //     if ($project_id) {","    //         $where = \" AND $expenses_table.project_id=$project_id\";","    //     }","","    //     $expenses = \"SELECT SUM($expenses_table.amount + IFNULL(tax_table.percentage,0)/100*IFNULL($expenses_table.amount,0) + IFNULL(tax_table2.percentage,0)/100*IFNULL($expenses_table.amount,0)) AS total, MONTH($expenses_table.expense_date) AS month","    //     FROM $expenses_table","    //     LEFT JOIN (SELECT $taxes_table.id, $taxes_table.percentage FROM $taxes_table) AS tax_table ON tax_table.id = $expenses_table.tax_id","    //     LEFT JOIN (SELECT $taxes_table.id, $taxes_table.percentage FROM $taxes_table) AS tax_table2 ON tax_table2.id = $expenses_table.tax_id2","    //     WHERE $expenses_table.deleted=0 AND YEAR($expenses_table.expense_date)= $year $where","    //     GROUP BY MONTH($expenses_table.expense_date)\";","","    //     return $this->db->query($expenses)->result();","    // }","","    // //get the recurring expenses which are ready to renew as on a given date","    // function get_renewable_expenses($date) {","    //     $expenses_table = $this->db->dbprefix('expenses');","","    //     $sql = \"SELECT * FROM $expenses_table","    //                     WHERE $expenses_table.deleted=0 AND $expenses_table.recurring=1","    //                     AND $expenses_table.next_recurring_date IS NOT NULL AND $expenses_table.next_recurring_date<='$date'","    //                     AND ($expenses_table.no_of_cycles < 1 OR ($expenses_table.no_of_cycles_completed < $expenses_table.no_of_cycles ))\";","","    //     return $this->db->query($sql);","    // }"],"id":14}],[{"start":{"row":25,"column":28},"end":{"row":25,"column":44},"action":"remove","lines":["material_request"],"id":15},{"start":{"row":25,"column":28},"end":{"row":25,"column":29},"action":"insert","lines":["i"]},{"start":{"row":25,"column":29},"end":{"row":25,"column":30},"action":"insert","lines":["t"]}],[{"start":{"row":25,"column":23},"end":{"row":25,"column":36},"action":"remove","lines":["$add_it_table"],"id":16},{"start":{"row":25,"column":23},"end":{"row":25,"column":38},"action":"insert","lines":["$add_item_table"]}],[{"start":{"row":25,"column":42},"end":{"row":25,"column":187},"action":"remove","lines":["$expense_categories_table.title as category_title, $location_categories_table.title as location_title, $status_mr_table.title as status_mr_title,"],"id":17},{"start":{"row":25,"column":41},"end":{"row":25,"column":42},"action":"remove","lines":[" "]}],[{"start":{"row":26,"column":0},"end":{"row":27,"column":55},"action":"remove","lines":["                 CONCAT($users_table.first_name, ' ', $users_table.last_name) AS linked_user_name,","                 $projects_table.title AS project_title"],"id":18},{"start":{"row":25,"column":41},"end":{"row":26,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":26,"column":18},"end":{"row":26,"column":34},"action":"remove","lines":["material_request"],"id":19},{"start":{"row":26,"column":18},"end":{"row":26,"column":19},"action":"insert","lines":["i"]},{"start":{"row":26,"column":19},"end":{"row":26,"column":20},"action":"insert","lines":["t"]},{"start":{"row":26,"column":20},"end":{"row":26,"column":21},"action":"insert","lines":["e"]}],[{"start":{"row":26,"column":13},"end":{"row":26,"column":27},"action":"remove","lines":["$add_ite_table"],"id":20},{"start":{"row":26,"column":13},"end":{"row":26,"column":28},"action":"insert","lines":["$add_item_table"]}],[{"start":{"row":27,"column":0},"end":{"row":31,"column":86},"action":"remove","lines":["        LEFT JOIN $location_categories_table ON $location_categories_table.id= $add_material_request_table.location_id","        LEFT JOIN $status_mr_table ON $status_mr_table.id= $add_material_request_table.status_id","        LEFT JOIN $expense_categories_table ON $expense_categories_table.id= $add_material_request_table.category_id","        LEFT JOIN $projects_table ON $projects_table.id= $add_material_request_table.project_id","        LEFT JOIN $users_table ON $users_table.id= $add_material_request_table.user_id"],"id":21},{"start":{"row":26,"column":28},"end":{"row":27,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":27,"column":19},"end":{"row":27,"column":35},"action":"remove","lines":["material_request"],"id":22},{"start":{"row":27,"column":19},"end":{"row":27,"column":20},"action":"insert","lines":["i"]},{"start":{"row":27,"column":20},"end":{"row":27,"column":21},"action":"insert","lines":["t"]},{"start":{"row":27,"column":21},"end":{"row":27,"column":22},"action":"insert","lines":["e"]}],[{"start":{"row":27,"column":14},"end":{"row":27,"column":28},"action":"remove","lines":["$add_ite_table"],"id":23},{"start":{"row":27,"column":14},"end":{"row":27,"column":29},"action":"insert","lines":["$add_item_table"]}],[{"start":{"row":2,"column":10},"end":{"row":2,"column":33},"action":"remove","lines":["material_request_model "],"id":24},{"start":{"row":2,"column":10},"end":{"row":2,"column":11},"action":"insert","lines":["i"]},{"start":{"row":2,"column":11},"end":{"row":2,"column":12},"action":"insert","lines":["t"]},{"start":{"row":2,"column":12},"end":{"row":2,"column":13},"action":"insert","lines":["e"]},{"start":{"row":2,"column":13},"end":{"row":2,"column":14},"action":"insert","lines":["m"]}],[{"start":{"row":2,"column":6},"end":{"row":2,"column":14},"action":"remove","lines":["Add_item"],"id":25},{"start":{"row":2,"column":6},"end":{"row":2,"column":20},"action":"insert","lines":["Add_item_model"]}],[{"start":{"row":2,"column":20},"end":{"row":2,"column":21},"action":"insert","lines":[" "],"id":26}],[{"start":{"row":15,"column":0},"end":{"row":16,"column":0},"action":"remove","lines":["",""],"id":27}],[{"start":{"row":14,"column":54},"end":{"row":15,"column":0},"action":"remove","lines":["",""],"id":28}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":14,"column":54},"end":{"row":14,"column":54},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1617602298445,"hash":"d7f2fa060bbab527ef5c7997ee1a0e83cb938e9a"}